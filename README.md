# 아키텍쳐

## 웹소켓

-   양방향 통신
    -   커넥션을 맺어 놓고, 해당 커넥션으로 통신
        -   네트워크 오버헤드 감소
        -   지연시간 감소(Latency)

## 서버의 역할

-   API: 사용자의 요청을 DB에 저장
-   Agent: OpenAI와 통신
-   가공된 데이터를 Chatting 서버에주고, 채팅 웹소켓에 준다

## 서버를 나누었을 때 좋은점

-   확장성, 유연성
-   기술 스택 선정 용이 : 서로 다른 스택을 사용할 수 있음
-   세분화된 모니터링 : 각 서버별로 모니터링 가능
-   접근 제어 세분화 : 각 서버마다 접근 제어를 다르게 둘 수 있음

## 서버 간 데이터 통신

-   질문 한번에 HTTP 통신 세번
-   서버에 장애 발생시 그대로 유실 (장애복구 힘듬)

**메세지 큐**

-   서버간 통신을 지원하는 시스템

    -   서버 사이에 메세지 큐를 두어, 메시지 전달/소비로 구성
    -   비동기 적으로 통신 가능
        -   API 서버가 큐에만 담아두고, Agent 서버에서는 큐에서 가져가지만 하면 됨
    -   결합도가 감소

        -   상대 서버가 무엇을 하는지 몰라도 됨

    -   장애복구
        -   오류가 발생해도 메시지 큐에 정보가 있어서 유실 방지됨

---

## Azure Function

Serverless 컴퓨팅의 일종

-   FasS, Function As A Service
    -   서버는 Azure가 제공, 개발자는 함수만 신경쓰면 됨

### 장점

-   개발 속도가 빨라짐
-   서버 세팅 생각 X --> 관리 부담 감소
-   비용 절감 --> 함수가 실행되는 것으로 판단하여 비용 책정(메모리, 시간)

### 단점

-   콜드 스타트

    -   서버가 24시간 떠있지 않고, 함수가 실행될 때 서버가 켜짐 --> 서버가 닫혀있을 때 첫 요청이 지연

-   벤더 종속성

    -   코드와 환경이 Azure에 종속되어 다른 서비스로 교체할 때 번거로움

-   제한된 환경
    -   Azure가 지원하는 것에 맞춰해야함

## Azure Cosmos DB

-   Serverless

얼마나 큰 데이터를 읽었는지, 자주 읽었는지로 비용 측정

---

# 언어 및 프레임 워크

-   FastAPI / Python 3.11
-   Node.js 20.14
    -   Azure Function 설치 시 필요
-   DB
    -   MongoDB 6.0
